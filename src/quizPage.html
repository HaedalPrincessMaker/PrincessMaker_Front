<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>퀴즈 목록</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div style="text-align: center;">
    <h1>Quiz 목록</h1>
  </div>

  <div id="quizListContainer" style="text-align: center;">
    <h2>퀴즈 목록</h2>
    <ul id="quizList" style="list-style: none; padding: 0;">
      <!-- 퀴즈 목록이 여기에 추가됩니다 -->
    </ul>
    <button class="add-button" onclick="location.href='quizForm.html'">퀴즈 추가</button>
  </div>

  <script>
    // 서버에서 퀴즈 목록을 가져오는 함수
    async function fetchQuizzes() {
      const response = await fetch('/quiz'); // GET /quiz
      const quizzes = await response.json();
      const quizList = document.getElementById('quizList');

      quizList.innerHTML = ''; // 기존 목록 초기화

      // 퀴즈 목록을 동적으로 생성
      quizzes.forEach(quiz => {
        const listItem = document.createElement('li');
        listItem.innerHTML = `
          ${quiz.question} 
          <button onclick="editQuiz(${quiz.id})">수정</button>
          <button class="delete-button" onclick="deleteQuiz(${quiz.id})">삭제</button>
        `;
        quizList.appendChild(listItem);
      });
    }

    // 퀴즈 수정 페이지로 이동
    function editQuiz(id) {
      localStorage.setItem('selectedQuizId', id);
      window.location.href = 'quizEdit.html';
    }

    // 퀴즈 삭제
    async function deleteQuiz(id) {
      if (confirm('정말로 삭제하시겠습니까?')) {
        const response = await fetch(`/api/quizzes/${id}`, {
          method: 'DELETE',
        });

        if (response.ok) {
          alert('퀴즈가 삭제되었습니다.');
          fetchQuizzes(); // 목록 다시 불러오기
        } else {
          alert('퀴즈 삭제 실패');
        }
      }
    }

    // 페이지 로드 시 퀴즈 목록 업데이트
    window.onload = fetchQuizzes;
  </script>
</body>
</html>
