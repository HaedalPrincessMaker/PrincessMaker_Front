<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>퀴즈 도전</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>퀴즈 도전</h1>
  <p id="quizQuestion">문제:</p>
  <form id="quizForm">
    <div class="options" id="quizOptions">
      <!-- 동적으로 선택지가 채워질 부분 -->
    </div>
    <button type="button" onclick="submitAnswer()">제출</button>
  </form>
  <p class="message hidden" id="feedback">실패! 기회는 1번 남았습니다.</p>
  <button class="hidden" id="retryButton" onclick="retry()">다시 도전하기</button>

  <script>
    let attempts = 2; // 최대 시도 횟수
    let correctAnswer; // 정답
    const quizQuestion = document.getElementById('quizQuestion');
    const quizOptions = document.getElementById('quizOptions');

    // 페이지 로드시 localStorage에서 퀴즈 정보 가져오기
    window.onload = function() {
      const selectedQuiz = JSON.parse(localStorage.getItem('selectedQuiz'));

      if (selectedQuiz) {
        quizQuestion.textContent = `문제: ${selectedQuiz.question}`;
        correctAnswer = selectedQuiz.correctAnswer;

        // 선택지 동적으로 생성
        selectedQuiz.options.forEach((option, index) => {
          const optionLabel = document.createElement('label');
          optionLabel.innerHTML = `
            <input type="radio" name="answer" value="${index + 1}"> ${index + 1}. ${option}
          `;
          quizOptions.appendChild(optionLabel);
          quizOptions.appendChild(document.createElement('br'));
        });
      } else {
        alert("퀴즈 데이터를 불러올 수 없습니다.");
      }
    };

    function submitAnswer() {
      const selectedAnswer = document.querySelector('input[name="answer"]:checked');

      if (!selectedAnswer) {
        alert("정답을 선택해주세요!");
        return;
      }

      if (selectedAnswer.value === correctAnswer) {
        alert("정답입니다! 축하합니다!");
        resetQuiz();  // 정답 시 퀴즈 목록 페이지로 이동
      } else {
        attempts--;
        if (attempts > 0) {
          document.getElementById('feedback').classList.remove('hidden');
          document.getElementById('retryButton').classList.remove('hidden');
        } else {
          alert("실패! 더 이상 기회가 없습니다.");
          resetQuiz();  // 실패 시 퀴즈 목록 페이지로 이동
        }
      }
    }

    function retry() {
      // 선택 초기화
      document.querySelector('input[name="answer"]:checked').checked = false;
      // 실패 후 페이지 이동 (옵션)
      window.location.href = 'retryPage.html';  // 재시도 페이지로 이동
    }

    function resetQuiz() {
      attempts = 2;
      document.getElementById('feedback').classList.add('hidden');
      document.getElementById('retryButton').classList.add('hidden');
      window.location.href = 'quizList.html';  // 퀴즈 목록 페이지로 이동
    }
  </script>
</body>
</html>
